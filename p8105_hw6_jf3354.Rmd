---
title: "p8105_hw6_jf3354"
author: Judy Fordjuoh
date: November 27, 2021
output: github_document
---

```{r, echo=FALSE}
library(tidyverse)
library(dplyr)
library(readxl)
library(haven)
library(ggplot2)
library(patchwork)
knitr::opts_chunk$set(
  fig.width = 6,
  fig.asp = .6,
  out.width = "90%"
)
theme_set(theme_minimal() + theme(legend.position = "bottom"))
options(
  ggplot2.continuous.colour = "viridis",
  ggplot2.continuous.fill = "viridis"
)
scale_colour_discrete = scale_color_viridis_d
scale_fill_discrete = scale_fill_viridis_d
```

## Question 1

```{r}
#Load and clean the data for regression analysis (i.e. convert numeric to factor where appropriate, check for missing data, etc.

bw = 
    read_csv("birthweight.csv") %>% 
 janitor::clean_names() %>% 
  mutate(
    babysex = as.factor(babysex),
    malform = as.factor(malform),
    frace = as.factor(frace),
    mrace = as.factor(mrace)
  ) #all the other variables are continuous so we won't convert them

#checking for NA's
bw %>%
  is.na() %>% 
  summary()

purrr::map(bw, ~ sum(is.na(.)))
```

#For my model I included risk factors that I have learned in previous classes have have an affect on birthweight of a child, specifically contributing to low birthweight. In terms of sociodemographics, I included the mom's race(mrace) and the family's monthly income (fincome) because this affects the type of health care she may be recieving. In terms of behavioral risk factors, I included smoken because maternal smoking during pregnancy and the smoking intensity has been consistently related to low birthweight. In terms of preganncy specific factors, I included the mothers age at delievery(momage), the mothers weight at the delivery(delwt), gestationsal age in weeks(gaweeks), presence of malformations(malform), number of live births prior to this pregancy(parity), previous number of low birth weight babies (pnumlbw) and the number of prior small for gestational age babies(pnumgsa) into the model.

```{r}
#Propose a regression model for birthweight. This model may be based on a hypothesized structure for the factors that underly birthweight, on a data-driven model-building process, or a combination of the two. Describe your modeling process and show a plot of model residuals against fitted values â€“ use add_predictions and add_residuals in making this plot.

fitted_model_1 = lm(bwt ~ mrace + fincome + smoken + momage + delwt + gaweeks + malform + parity + pnumlbw + pnumsga, data = bw)

summary(fitted_model_1)

bw %>% 
  modelr::add_residuals(fitted_model_1) %>%
  modelr::add_predictions(fitted_model_1) %>% 
  ggplot(aes(x = pred, y = resid)) + 
  geom_point(alpha = 0.3) +
  geom_smooth(se = TRUE, color = "red", method = "lm") +
  labs(
    title = "Predicted vs. Residuals",
    x = "Predicted",
    y = "Residuals") +
  theme(plot.title = element_text(hjust = 0.5))

```
# Prediction values seem to be concentrated between 2600 and 3600 while the residual values seem to aggregate between -750 and 750. Now we will compared our model to two other models: 1. one predicting birth weight using length at birth baby and gestational age as the only main effects and 2.head circumference, length at birth baby, sex, and all interactions beteween these 3 variables to predict birth weight. 
```{r}

```




## Question 2

```{r}

```
