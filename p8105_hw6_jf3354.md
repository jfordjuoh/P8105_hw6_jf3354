p8105\_hw6\_jf3354
================
Judy Fordjuoh
November 27, 2021

    ## ── Attaching packages ─────────────────────────────────────── tidyverse 1.3.1 ──

    ## ✓ ggplot2 3.3.5     ✓ purrr   0.3.4
    ## ✓ tibble  3.1.5     ✓ dplyr   1.0.7
    ## ✓ tidyr   1.1.3     ✓ stringr 1.4.0
    ## ✓ readr   2.0.1     ✓ forcats 0.5.1

    ## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
    ## x dplyr::filter() masks stats::filter()
    ## x dplyr::lag()    masks stats::lag()

## Question 1

``` r
#Load and clean the data for regression analysis (i.e. convert numeric to factor where appropriate, check for missing data, etc.

bw = 
    read_csv("birthweight.csv") %>% 
 janitor::clean_names() %>% 
  mutate(
    babysex = as.factor(babysex),
    malform = as.factor(malform),
    frace = as.factor(frace),
    mrace = as.factor(mrace)
  ) #all the other variables are continuous so we won't convert them
```

    ## Rows: 4342 Columns: 20

    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## dbl (20): babysex, bhead, blength, bwt, delwt, fincome, frace, gaweeks, malf...

    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

``` r
#checking for NA's
bw %>%
  is.na() %>% 
  summary()
```

    ##   babysex          bhead          blength           bwt         
    ##  Mode :logical   Mode :logical   Mode :logical   Mode :logical  
    ##  FALSE:4342      FALSE:4342      FALSE:4342      FALSE:4342     
    ##    delwt          fincome          frace          gaweeks       
    ##  Mode :logical   Mode :logical   Mode :logical   Mode :logical  
    ##  FALSE:4342      FALSE:4342      FALSE:4342      FALSE:4342     
    ##   malform         menarche        mheight          momage       
    ##  Mode :logical   Mode :logical   Mode :logical   Mode :logical  
    ##  FALSE:4342      FALSE:4342      FALSE:4342      FALSE:4342     
    ##    mrace           parity         pnumlbw         pnumsga       
    ##  Mode :logical   Mode :logical   Mode :logical   Mode :logical  
    ##  FALSE:4342      FALSE:4342      FALSE:4342      FALSE:4342     
    ##    ppbmi            ppwt           smoken          wtgain       
    ##  Mode :logical   Mode :logical   Mode :logical   Mode :logical  
    ##  FALSE:4342      FALSE:4342      FALSE:4342      FALSE:4342

``` r
purrr::map(bw, ~ sum(is.na(.)))
```

    ## $babysex
    ## [1] 0
    ## 
    ## $bhead
    ## [1] 0
    ## 
    ## $blength
    ## [1] 0
    ## 
    ## $bwt
    ## [1] 0
    ## 
    ## $delwt
    ## [1] 0
    ## 
    ## $fincome
    ## [1] 0
    ## 
    ## $frace
    ## [1] 0
    ## 
    ## $gaweeks
    ## [1] 0
    ## 
    ## $malform
    ## [1] 0
    ## 
    ## $menarche
    ## [1] 0
    ## 
    ## $mheight
    ## [1] 0
    ## 
    ## $momage
    ## [1] 0
    ## 
    ## $mrace
    ## [1] 0
    ## 
    ## $parity
    ## [1] 0
    ## 
    ## $pnumlbw
    ## [1] 0
    ## 
    ## $pnumsga
    ## [1] 0
    ## 
    ## $ppbmi
    ## [1] 0
    ## 
    ## $ppwt
    ## [1] 0
    ## 
    ## $smoken
    ## [1] 0
    ## 
    ## $wtgain
    ## [1] 0

\#For my model I included risk factors that I have learned in previous
classes have have an affect on birthweight of a child, specifically
contributing to low birthweight. In terms of sociodemographics, I
included the mom’s race(mrace) and the family’s monthly income (fincome)
because this affects the type of health care she may be recieving. In
terms of behavioral risk factors, I included smoken because maternal
smoking during pregnancy and the smoking intensity has been consistently
related to low birthweight. In terms of preganncy specific factors, I
included the mothers age at delievery(momage), the mothers weight at the
delivery(delwt), gestationsal age in weeks(gaweeks), presence of
malformations(malform), number of live births prior to this
pregancy(parity), previous number of low birth weight babies (pnumlbw)
and the number of prior small for gestational age babies(pnumgsa) into
the model.

``` r
#Propose a regression model for birthweight. This model may be based on a hypothesized structure for the factors that underly birthweight, on a data-driven model-building process, or a combination of the two. Describe your modeling process and show a plot of model residuals against fitted values – use add_predictions and add_residuals in making this plot.

fitted_model_1 = lm(bwt ~ mrace + fincome + smoken + momage + delwt + gaweeks + malform + parity + pnumlbw + pnumsga, data = bw)

summary(fitted_model_1)
```

    ## 
    ## Call:
    ## lm(formula = bwt ~ mrace + fincome + smoken + momage + delwt + 
    ##     gaweeks + malform + parity + pnumlbw + pnumsga, data = bw)
    ## 
    ## Residuals:
    ##      Min       1Q   Median       3Q      Max 
    ## -1742.52  -259.46     3.41   274.07  1550.71 
    ## 
    ## Coefficients: (2 not defined because of singularities)
    ##              Estimate Std. Error t value Pr(>|t|)    
    ## (Intercept)  301.1751    95.9958   3.137  0.00172 ** 
    ## mrace2      -290.9975    15.6729 -18.567  < 2e-16 ***
    ## mrace3       -44.1013    66.7164  -0.661  0.50863    
    ## mrace4      -138.6802    29.6684  -4.674 3.04e-06 ***
    ## fincome        0.3961     0.2790   1.420  0.15575    
    ## smoken       -11.6250     0.9057 -12.836  < 2e-16 ***
    ## momage        -1.6694     1.8522  -0.901  0.36747    
    ## delwt          5.8947     0.2979  19.785  < 2e-16 ***
    ## gaweeks       54.6749     2.1153  25.847  < 2e-16 ***
    ## malform1      -7.0240   110.4386  -0.064  0.94929    
    ## parity       113.7022    63.2743   1.797  0.07241 .  
    ## pnumlbw            NA         NA      NA       NA    
    ## pnumsga            NA         NA      NA       NA    
    ## ---
    ## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
    ## 
    ## Residual standard error: 426.5 on 4331 degrees of freedom
    ## Multiple R-squared:  0.3082, Adjusted R-squared:  0.3066 
    ## F-statistic: 192.9 on 10 and 4331 DF,  p-value: < 2.2e-16

``` r
bw %>% 
  modelr::add_residuals(fitted_model_1) %>%
  modelr::add_predictions(fitted_model_1) %>% 
  ggplot(aes(x = pred, y = resid)) + 
  geom_point(alpha = 0.3) +
  geom_smooth(se = TRUE, color = "red", method = "lm") +
  labs(
    title = "Predicted vs. Residuals",
    x = "Predicted",
    y = "Residuals") +
  theme(plot.title = element_text(hjust = 0.5))
```

    ## Warning in predict.lm(model, data): prediction from a rank-deficient fit may be
    ## misleading

    ## Warning in predict.lm(model, data): prediction from a rank-deficient fit may be
    ## misleading

    ## `geom_smooth()` using formula 'y ~ x'

<img src="p8105_hw6_jf3354_files/figure-gfm/unnamed-chunk-3-1.png" width="90%" />
\# Prediction values seem to be concentrated between 2600 and 3600 while
the residual values seem to aggregate between -750 and 750. Now we will
compared our model to two other models: 1. one predicting birth weight
using length at birth baby and gestational age as the only main effects
and 2.head circumference, length at birth baby, sex, and all
interactions beteween these 3 variables to predict birth weight.

## Question 2
